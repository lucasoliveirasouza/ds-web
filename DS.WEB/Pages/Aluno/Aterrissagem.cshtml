@page
@model DS.WEB.Pages.Aluno.AterrissagemAlunoModel
@{
    Layout = "_LayoutAterrissagem";
    ViewData["tituloFuncao"] = "Alunos";
}

<div class="row">
    <div class="col-xl-12">
        <vc:grid options="@(Html.GridOptions(m => m.Alunos)
                                 .AddColumn(c => c.Bound(m => m.Matricula).FlexBasis(200))
                                 .AddColumn(c => c.Bound(m => m.Nome))
                                 .AddAction(a => a.Remover())
                                 .AddAction(a => a.Editar()))"></vc:grid>

    </div>
</div>

<script defer>
EventDomContentLoaded(async () => {
    await pesquiseAlunos();

    const botaoCadastrar = document.getElementById('cadastrar');
    botaoCadastrar.addEventListener('click', (ev) => {
        ev.preventDefault();
        window.location.href = '/Aluno/Cadastrar';
    })
})

async function pesquiseAlunos() {
    debugger;
    const optionsFetch = {
        url: `${APIHelper.LocalHost}/Aluno`,
        method: "GET"
    }
    const resposta = await postJSON(optionsFetch);
    if (resposta.data) {
        const alunos = resposta.data.map(aluno => {
            return {
                Nome: aluno.nome,
                Matricula: 1
            }
        });
        Grid_Alunos.addRange(alunos);
    }
}
</script>